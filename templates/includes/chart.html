<script>
'use strict';

$(document).ready(function() {

    // ---------- Pie Chart ----------
    var pieOptions = {
        series: [{{ student_count }}, {{ staff_count }}, {{ subject_count }}, {{ course_count }}],
        chart: {
            height: 350,
                width: '100%',
            type: 'pie'
        },
        labels: ['Student', 'Staff', 'Subject', 'Course'],
        responsive: [{
            breakpoint: 480,
            options: {
                chart: {
                    width: 200
                },
                legend: {
                    position: 'bottom'
                }
            }
        }]
    };

    var pieChart = new ApexCharts(document.querySelector("#All_details"), pieOptions);
    pieChart.render();

    // ---------- Bar Chart ----------
    if ($('#stud_gender').length > 0) {

        // Ensure integers (fallback to 0)
        var maleCount = parseInt('{{ student_gender_male|default:"0" }}', 10);
        var femaleCount = parseInt('{{ student_gender_female|default:"0" }}', 10);

        var barOptions = {
            chart: {
                type: 'bar',
                height: 350,
                width: '100%',
                stacked: true,
                toolbar: {
                    show: false
                }
            },
            plotOptions: {
                bar: {
                    columnWidth: '45%'
                }
            },
            dataLabels: {
                enabled: false
            },
            series: [
                {
                    name: "Boys",
                    data: [maleCount],
                    color: '#fdbb38'
                },
                {
                    name: "Girls",
                    data: [femaleCount],
                    color: '#19affb'
                }
            ],
            xaxis: {
                categories: ['Students'],
                labels: { show: true },
                axisBorder: { show: false },
                axisTicks: { show: false }
            },
            yaxis: {
                axisBorder: { show: false },
                axisTicks: { show: false },
                labels: {
                    style: { colors: '#777' }
                }
            },
            title: {
                text: '',
                align: 'left',
                style: { fontSize: '18px' }
            }
        };

        var barChart = new ApexCharts(document.querySelector('#stud_gender'), barOptions);
        barChart.render();
    }

	//student and staff
	  
        var options = {
          series: [{{student_count}},{{staff_count}}],
          chart: {
          type: 'donut',
        },
		 labels: ['Student', 'Staff'],
        responsive: [{
          breakpoint: 480,
          options: {
            chart: {
               height: 350,
                width: '100%',
            },
            legend: {
              position: 'bottom'
            }
          }
        }]
        };

        var chart = new ApexCharts(document.querySelector("#stud_staff"), options);
        chart.render();


		//course & subject
		
        var options = {
          series: [{{course_count}},{{subject_count}}],
          chart: {
           height: 350,
                width: '100%',
          type: 'donut',
        },
        plotOptions: {
          pie: {
            startAngle: -90,
            endAngle: 270
          }
        },
        dataLabels: {
          enabled: false
        },
        fill: {
          type: 'gradient',
        },
        legend: {
          formatter: function(val, opts) {
            return val + " - " + opts.w.globals.series[opts.seriesIndex]
          }
        },
        
		labels: ['Course','Subject'],
        responsive: [{
          breakpoint: 480,
          options: {
            chart: {
              width: 200
            },
            legend: {
              position: 'bottom'
            }
          }
        }]
        };

        var chart = new ApexCharts(document.querySelector("#course_subject"), options);
        chart.render();

});
</script>
